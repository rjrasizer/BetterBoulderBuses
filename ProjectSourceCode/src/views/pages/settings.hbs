<div class="settings-page">

  <!-- Header -->
  <div class="settings-header">
    <div class="settings-tabs">

      <a href="/home" class="tab-btn back-btn">‚Üê Back</a>

      <a href="/settings?tab=profile"
         class="tab-btn {{#if (eq activeTab 'profile')}}active{{/if}}">
        Account
      </a>

      <a href="/settings?tab=help"
         class="tab-btn {{#if (eq activeTab 'help')}}active{{/if}}">
        Help
      </a>

      <a href="/logout" class="tab-btn logout-btn">Logout</a>

    </div>
  </div>


  <!-- Main Body -->
  <div class="settings-container">
    <div class="settings-card">


      {{!-- ====================== ACCOUNT TAB ====================== --}}
      {{#if (eq activeTab "profile")}}

      <h3 class="settings-title">Manage Account</h3>

      <!-- Username (non-editable) -->
      <div class="mb-3">
        <label class="form-label">Email</label>
        <input 
          class="form-control bg-light"
          type="text"
          value="{{userData.username}}"
          disabled
        >
      </div>

      <div class="section-divider"></div>

      {{#if message}}
        <div class="alert {{#if error}}alert-danger{{else}}alert-success{{/if}}">
          {{message}}
        </div>
      {{/if}}

      <h5 class="settings-subtitle">Change Password</h5>

      <form method="POST" action="/settings/change-password">

        <div class="mb-3">
          <input 
            type="password" 
            name="currentPassword"
            class="form-control"
            placeholder="Current password"
            required
          >
        </div>

        <div class="mb-3">
          <input 
            type="password" 
            name="newPassword"
            class="form-control"
            placeholder="New password"
            required
          >
        </div>

        <div class="mb-4">
          <input 
            type="password" 
            name="confirmPassword"
            class="form-control"
            placeholder="Confirm new password"
            required
          >
        </div>

        <button type="submit" class="btn btn-outline-dark">
          Update Password
        </button>

      </form>

      {{/if}}



      {{!-- ======================= HELP TAB ========================== --}}
      {{#if (eq activeTab "help")}}

      <h3 class="settings-title">Help & Support</h3>

      <div class="faq-container">

        <!-- FAQ ITEM 1 -->
        <div class="faq-item">
          <button class="faq-question" type="button">
            How do I track a bus in real time?
          </button>
          <div class="faq-answer">
            Open the sidebar to view nearby routes.  
            Tap a route to load its live map view and stop ETAs.  
            Bus positions update automatically every few seconds.
          </div>
        </div>

        <!-- FAQ ITEM 2 -->
        <div class="faq-item">
          <button class="faq-question" type="button">
            Why does the bus sometimes look delayed or stop moving?
          </button>
          <div class="faq-answer">
            RTD's GPS feed can freeze or lag temporarily.  
            Buses may also pause at scheduled time points.  
            These pauses can make the bus appear stopped even when it's on time.
          </div>
        </div>

        <!-- FAQ ITEM 3 -->
        <div class="faq-item">
          <button class="faq-question" type="button">
            Why can't the app always find my nearest stop?
          </button>
          <div class="faq-answer">
            The app relies on your device's location accuracy.  
            Weak GPS signal, denied permissions, or being indoors can limit precision.  
            Enable location access and move near a window when possible.
          </div>
        </div>

      </div>

      {{/if}}

    </div>
  </div>

</div>


<!-- FAQ Dropdown Script -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  const questions = document.querySelectorAll(".faq-question");

  questions.forEach(q => {
    q.addEventListener("click", () => {
      const answer = q.nextElementSibling;

      // Close all other answers
      document.querySelectorAll(".faq-answer").forEach(a => {
        if (a !== answer) a.style.display = "none";
      });

      // Toggle this answer
      answer.style.display =
        answer.style.display === "block" ? "none" : "block";
    });
  });
});
</script>

<script src="/js/register.js" defer></script>
